---
title: "Gov 50 Final Project"
author: "Jordy Chaves"
description: "My Final Project"
output:
  distill::distill_article:
    self_contained: false
---

## Data:

```{r}
library(dplyr)
library(tidyverse)
library(ggplot2)
Data <- read_csv("Data/spi_matches.csv")

Data <- Data |>
  drop_na()

pl_table_2016 <- Data |>
  filter(league == "Barclays Premier League", season == "2016") |>
  mutate(result = case_when(score1 > score2 ~ " Home Win",
                            score1 < score2 ~ "Home Loss",
                            score2 == score1 ~ "Draw"),
         result1 = case_when(score1 > score2 ~ 1,
                            score1 < score2 ~ 0,
                            score2 == score1 ~ 0)) |>
  group_by(importance1, importance2)
pl_table_2016
  
pl_importance <- ggplot(data = pl_table_2016, mapping = aes(x = importance1)) +
    geom_histogram() +
    labs(x = "Degree of Importance of a Game to the Home Team", y = "Count")
pl_importance
```

## Proposal:


Does the importance of a soccer game influence whether or not a team wins a game? In this study, I plan to examine if a game is deemed more important for a team, will that team win that game. I hypothesize that teams will win a game when it is more important to them than it is to their opponent. My sample is comprised of the 20 English Premier League teams in the 2016 season. I will be using the spi.matches.csv dataset. My unit of analysis will be a team (e.g. Manchester United, Leicester City, etc.). The explanatory variable of interest is how important a game is to a team (importance1 for a home team and importance 2 for an away team). The explanatory variable is measured on a scale of 0-100, 0 meaning not important and 100 meaning the most important. My outcome variable would be a count of the number of wins each team has on a range of how important the games were (e.g., count of wins in games that range from 0-20 in importance, 20-40, 40-60, etc.). If I observe more wins when the importance of the game is higher, then this will provide support for my hypothesis. If I observe more wins when the game is of less importance to a team, then this will provide evidence against my hypothesis.


Milestone #4:


```{r}
count_table <- pl_table_2016 |>
  ggplot(aes(x = result)) +
  geom_bar(mapping = aes(fill = result))
count_table
```




Linear Regression for Importance of Games for Premier League Teams

```{r}
library(texreg)
fit1 <- lm(result1 ~ importance1 + importance2 + xg1 + xg2 + spi1 + spi2 + prob1 + prob2 + probtie + proj_score2 + proj_score1 + score1 + score2, data = pl_table_2016)

screenreg(fit1, digits = 3)

pl_table_2016 |>
  ggplot(aes(x = importance1, y = prob1)) +
  geom_point() +
  facet_wrap(~result1) +
  labs(x = "Importance of the Game to a Home Team", y = "Result",title = "Regression Between the Importance of a Home Match to a Team and the Result of the Match")

```
If there is one unit increase in importance, the probability of a home win will increase by 0.4 percentage points. If there is an importance increase from 0 to 100 there will be a 40 percentage point increase in the probability of the home team winning. I believe that this effect is substantial. The p-value is extremely small which means that there is a statistically significant correlation between importance and the result of the game.

# A Study on A Home Team's Performance Relative to the Importance of Their Game

## Introduction

  Does the importance of a soccer game influence whether or not a home team wins a game? In this study, I want to observe the relationship between a match's importance to a home team and the result of that match for the team. I hypothesize that as a match increases in importance, a home team will be more likely to win their game. My sample for this study is comprised of the 20 English Premier League teams in the 2016-2017 season. I will be using the spi.matches.csv dataset to in this research. My unit of analysis will be a home team (for each individual game). The explanatory variable of interest is how important a game is to a home team (importance1 measures the importance of a home team). The explanatory variable is measured on a scale of 0-100, 0 meaning not important and 100 meaning the most important. My outcome variable is the results of a game for a home team. If I observe a positive linear relationship between the importance of a match to a home team and the result, then this will provide support for my hypothesis. If there is a negative relationship, then this would provide support against my hypothesis as this would mean that the more important the game, the less a home team wins. 
  
  The study is important in order to try and understand how best to predict a sports game. There are many variables that go into predicting the result of a soccer match, but if we can isolate the importance of a game as the explanatory variable, then we will can form more accurate predictions.
  
## Data

[INSERT INFO HERE]

## Results

[INSERT INFO HERE]

## Conclusion

[INSERT INFO HERE]
